{% xlsdocument %}
    {% xlssheet 'Worksheet' {
        columnDimension: {
            'A': {
                width: 40
            },
            'B': {
                width: 70
            },
            'C': {
                width: 25
            },
            'D': {
                width: 30
            },
            'E': {
                width: 25
            },
            'F': {
                width: 10
            },
            'G': {
                width: 10
            },
            'H': {
                width: 10
            },
            'I': {
                width: 10
            },
            'J': {
                width: 10
            },
            'K': {
                width: 10
            },
            'L': {
                width: 10
            },
            'M': {
                width: 10
            },
            'N': {
                width: 10
            },
            'O': {
                width: 10
            },
            'P': {
                width: 10
            },
            'Q': {
                width: 10
            },
        },
        rowDimension: {
            'default': {
                rowHeight: 20,
            },
        },
    }%}
        {% xlsrow %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } },  } } %}Database Report 1 (R4){% endxlscell %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}Total Searches, Result Clicks and Record Views by Month and Database{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ customer }}{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ customerIdentifier }}{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}Period covered by report:{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ "1 January"|date("Y-m-d") }} to {{ "last day of last month"|date("Y-m-d") }}{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}Date run:{% endxlscell %}
        {% endxlsrow %}
        {% xlsrow %}
            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ "now"|date("Y-m-d") }}{% endxlscell %}
        {% endxlsrow %}

        {% xlsrow %}
            {% xlscell { style: { font: { size: '11', bold: 'true' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } }, fill: { type: 'solid', color: { rgb: '95B3D6' } } } } %}Database{% endxlscell %}
            {% xlscell { style: { font: { size: '11', bold: 'true' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } }, top: { style: 'thin', color: { rgb: '000000' } } }, fill: { type: 'solid', color: { rgb: '95B3D6' } } } } %}Publisher{% endxlscell %}
            {% xlscell { style: { font: { size: '11', bold: 'true' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } }, top: { style: 'thin', color: { rgb: '000000' } } }, fill: { type: 'solid', color: { rgb: '95B3D6' } } } } %}Platform{% endxlscell %}
            {% xlscell { style: { font: { size: '11', bold: 'true' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } }, top: { style: 'thin', color: { rgb: '000000' } } }, fill: { type: 'solid', color: { rgb: '95B3D6' } } } } %}User Activity{% endxlscell %}
            {% xlscell { style: { font: { size: '11', bold: 'true' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } }, top: { style: 'thin', color: { rgb: '000000' } } }, fill: { type: 'solid', color: { rgb: '95B3D6' } } } } %}Reporting Period Total{% endxlscell %}

            {% for value in reportingPeriod %}
                    {% xlscell { style: { font: { size: '11', bold: 'true' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } }, top: { style: 'thin', color: { rgb: '000000' } } }, fill: { type: 'solid', color: { rgb: '95B3D6' } } } } %}{{ value }}{% endxlscell %}
            {% endfor %}
        {% endxlsrow %}

        {% for key, value in databaseReport1 %}

            {% set x = 1 %}

            {% for key1, value1 in value %}

                {% for key2, value2 in value1 %}

                    {% xlsrow %}
                        {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ fulltitleArr[key1]|raw }} ({{ key1 }}){% endxlscell %}
                        {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ publisherArr[key1] }}{% endxlscell %}
                        {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ platform }}{% endxlscell %}
                        {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ key2 }}{% endxlscell %}
                        {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}=SUM(F{{ 8 + x }}:Q{{ 8 + x }}){% endxlscell %}

                    {% if value2 is not empty %}
                        {% for key3, value3 in value2 %}
                            {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}{{ value3 }}{% endxlscell %}
                        {% endfor %}
                    {% else %}
                        {% xlscell { style: { font: { size: '11' }, borders: { bottom: { style: 'thin', color: { rgb: '000000' } }, right: { style: 'thin', color: { rgb: '000000' } } } } } %}0{% endxlscell %}
                    {% endif %}

                    {% set x = x + 1 %}

                    {% endxlsrow %}

                {% endfor %}
            {% endfor %}
        {% endfor %}

    {% endxlssheet %}
{% endxlsdocument %}